
#Recreate deployment

apiVersion: apps/v1
kind: Deployment
metadata:
  name: javawebappdep
  namespace: test
spec:
  replicas: 2
  strategy:
    type: Recreate
  selector:
    matchLabels:
      app: javawebapp
  template:
    metadata:
      name: javawebapp
      labels:
        app: javawebapp
    spec:
      containers:
      - name: javawebapp
        image: kkeducation12345/spring-app:1.0.0
        ports:
        - containerPort: 8080
---
apiVersion: v1
kind: Service
metadata:
  name: javawebappsvc
  namespace: test
spec:
  type: NodePort
  selector:
    app: javawebapp
  ports:
  - port: 80
    targetPort: 8080




#RollingUpdate deployment

apiVersion: apps/v1
kind: Deployment
metadata:
  name: javawebappdep
  namespace: test
spec:
  replicas: 2
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app: javawebapp
  template:
    metadata:
      name: javawebapp
      labels:
        app: javawebapp
    spec:
      containers:
      - name: javawebapp
        image: kkeducation12345/spring-app:1.0.0
        ports:
        - containerPort: 8080
---
apiVersion: v1
kind: Service
metadata:
  name: javawebappsvc
  namespace: test
spec:
  type: NodePort
  selector:
    app: javawebapp
  ports:
  - port: 80
    targetPort: 8080

euality based selector vs set based selector 
Right now your Deployment selector is:

selector:
  matchLabels:
    app: javawebapp


This is equality-based (only app=javawebapp).



üîπ If you want to use set-based labels

You replace matchLabels with matchExpressions. Example:

selector:
  matchExpressions:
    - key: app
      operator: In
      values:
        - javawebapp
        - testapp

üîπ Explanation

key: app ‚Üí the label key we are checking.

operator: In ‚Üí means ‚Äúmatch if the label value is one of these.‚Äù

values: [javawebapp, testapp] ‚Üí Pods with app=javawebapp OR app=testapp will be selected.


apiVersion: apps/v1
kind: Deployment
metadata:
  name: javawebappdep
  namespace: test-ns
spec:
  replicas: 2
  strategy:
    type: Recreate
  selector:
    matchExpressions:
      - key: app
        operator: In
        values:
          - javawebapp
          - testapp
  template:
    metadata:
      name: javawebapp
      labels:
        app: javawebapp   # Pod will have this label
    spec:
      containers:
      - name: javawebapp
        image: kkeducation12345/spring-app:1.0.5
        ports:
        - containerPort: 8080

